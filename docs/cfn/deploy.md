---
id: deploy
title: 継続的デリバリー 🚀
sidebar_label: 継続的デリバリー
---

import useBaseUrl from "@docusaurus/useBaseUrl";

前章では、CloudFormation のテストとして３点紹介しました。

1. **Linter による静的構文解析** <br/>
   テンプレートファイルに構文エラーはないか、決められたポリシーに従っているか、セキュリティ的に脆弱な記述はないかを検証する。

2. **変更セットによる検証** <br/>
   変更セットが作成されるか検証する。

3. **別リージョンへのデプロイ** <br/>
   別リージョンに全く同じ構成でデプロイができるか検証する。

本章では、上記のテストを CI/CD パイプラインで実践する場合の具体的な設定方法、インフラの構築自動化もパイプラインに組み込む際のポイントについて説明します。

## テストを CI/CD パイプラインで実践する

CI/CD パイプラインで CloudFormation のテストを行う場合、ワークフローは以下のようになります。

<div style={{ textAlign: "center", paddingTop: 30, paddingBottom: 30 }}>
  <img alt="Docusaurus with Keytar" src={useBaseUrl("img/testing.png")} />
</div>

構文テスト・セキュリティテスト・ポリシーテストなどの静的構文解析のテストは並列で実施します。
変更セットによる検証や別リージョンへのデプロイと比べると、検証時間が短いため一番初めに実施すると良いでしょう。

別リージョンへのデプロイはある程度時間がかかるので、開発用の feature ブランチで毎回実行するかどうかは、開発チームの方針に合わせて決定しましょう。

例えば以下のようなブランチ運用がオススメです。

:::tip ブランチ運用（例１）

- master ブランチにマージするとプロダクション環境にデプロイされる。
- develop ブランチにマージすると Taskcat が別リージョンに環境を作成するテストを行う。

:::

:::tip ブランチ運用（例２）

- master ブランチにマージするとプロダクション環境にデプロイされる。
- develop ブランチにマージするとテスト環境にデプロイされる。
- feature ブランチにコミットすると、Taskcat が別リージョンに環境を作成するテストを行う。

:::

開発組織に合った最適なブランチ戦略とテストを検討して下さい。

## CI/CD パイプラインからインフラを自動構築する

TODO
